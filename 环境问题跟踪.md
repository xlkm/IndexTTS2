# IndexTTS2 环境问题跟踪

**最后更新**: 2026-01-22  
**系统**: macOS (Darwin 23.5.0) - Mac Air M2

## 📊 问题总览

| 状态 | 问题 | 优先级 | 进度 |
|------|------|--------|------|
| ✅ | 仓库不匹配问题 | 高 | 已完成 |
| ⏳ | Python 版本兼容性 | 中 | 待处理 |
| ⏳ | 缺失的依赖库 | 高 | 待处理 |
| ⏳ | environment.yml 配置 | 中 | 部分完成 |
| ⏳ | Dockerfile 配置 | 低 | 待处理 |

---

## ✅ 已解决的问题

### 1. 仓库不匹配问题 ✅

**问题描述**: 
- Git 远程仓库是 `vocabulary-test`，但本地项目是 `IndexTTS2`
- 所有 IndexTTS2 项目文件都未添加到 Git

**解决方案**:
- ✅ 在 IndexTTS2 目录内初始化新的独立 Git 仓库
- ✅ 添加所有项目文件到 Git（44个文件）
- ✅ 创建初始提交
- ✅ 在 GitHub 上创建新仓库：https://github.com/xlkm/IndexTTS2.git
- ✅ 连接本地仓库到远程并推送

**完成时间**: 2026-01-22  
**相关文件**: 
- `仓库设置说明.md`
- `GitHub创建仓库步骤.md`
- `快速连接GitHub.md`
- `connect_to_github.sh`

**当前状态**: 
- 本地仓库：干净的工作区，3个提交
- 远程仓库：已连接并同步
- 分支跟踪：`main` → `origin/main`

---

## ⏳ 待解决的问题

### 2. Python 版本兼容性 ⏳

**问题描述**: 
- 当前使用 Python 3.11.3
- 文档推荐 Python 3.10（Mac M2 最佳兼容性）
- IndexTTS2 官方支持范围：3.7-3.10

**影响**: 
- 可能遇到未测试的兼容性问题
- 某些依赖库可能不支持 Python 3.11

**解决方案**:
- [ ] 创建 Python 3.10 的 conda 环境
- [ ] 在新环境中安装所有依赖
- [ ] 测试 IndexTTS2 功能是否正常
- [ ] 如果 3.11.3 可用，记录兼容性测试结果

**优先级**: 中  
**相关文档**: 
- `Mac_M2配置差异与优化建议.md`
- `docs/Mac_M2环境配置指南.md`

**建议命令**:
```bash
conda create -n indextts2 python=3.10 -y
conda activate indextts2
```

---

### 3. 缺失的依赖库 ⏳

**问题描述**: 
- Librosa：未安装（音频处理）
- SoundFile：未安装（音频I/O）
- 其他依赖可能也未安装

**影响**: 
- 无法进行音频处理
- 无法运行推理和训练脚本

**解决方案**:
- [ ] 安装系统依赖：`brew install libsndfile`
- [ ] 安装 Librosa：`pip install librosa`
- [ ] 安装 SoundFile：`pip install soundfile`
- [ ] 验证所有 requirements.txt 中的依赖
- [ ] 测试音频处理功能

**优先级**: 高  
**相关文档**: 
- `requirements.txt`
- `docs/环境检查报告.md`

**建议命令**:
```bash
# 安装系统依赖
brew install libsndfile

# 安装 Python 库
pip install librosa soundfile

# 验证安装
python3 -c "import librosa; import soundfile; print('音频库OK')"
```

---

### 4. environment.yml 配置 ⏳

**问题描述**: 
- 原配置包含 `cudatoolkit=11.3`（Mac M2 不支持 CUDA）
- 原配置使用 Python 3.8（建议改为 3.10）

**当前状态**: 
- ✅ 已更新 environment.yml（移除 CUDA，改为 Python 3.10，PyTorch 2.0+）
- ⏳ 需要测试新配置是否可用

**解决方案**:
- [x] 更新 environment.yml 配置
- [ ] 使用新配置创建 conda 环境
- [ ] 验证环境是否正常工作
- [ ] 测试 MPS 加速功能

**优先级**: 中  
**相关文件**: 
- `environment.yml`（已更新）

**建议命令**:
```bash
conda env create -f environment.yml
conda activate indextts2
```

---

### 5. Dockerfile 配置 ⏳

**问题描述**: 
- Dockerfile 使用 CUDA 版本（Mac M2 不支持）
- Mac M2 通常不需要 Docker（直接运行即可）

**影响**: 
- 在 Mac M2 上无法使用 Docker 配置
- 如果需要 Docker，需要创建 Mac M2 专用版本

**解决方案**:
- [ ] 评估是否需要 Docker（Mac M2 通常不需要）
- [ ] 如需要，创建 Mac M2 专用的 Dockerfile（使用 CPU 或 ARM64 镜像）
- [ ] 或标记为可选配置

**优先级**: 低  
**相关文件**: 
- `Dockerfile`

---

## 📋 下一步行动计划

### 立即处理（高优先级）
1. **安装缺失的依赖库**
   - 安装 libsndfile（系统依赖）
   - 安装 librosa 和 soundfile
   - 验证安装

### 近期处理（中优先级）
2. **Python 版本兼容性**
   - 创建 Python 3.10 环境
   - 测试兼容性
   - 决定使用哪个版本

3. **测试 environment.yml**
   - 使用新配置创建环境
   - 验证功能

### 可选处理（低优先级）
4. **Dockerfile 配置**
   - 评估需求
   - 如需要，创建 Mac M2 版本

---

## 📝 问题解决记录

### 2026-01-22
- ✅ **解决**: 仓库不匹配问题
  - 创建独立 Git 仓库
  - 连接 GitHub 远程仓库
  - 推送所有文件到 GitHub

### 待记录
- 每次解决问题后，在此处添加记录

---

## 🔗 相关文档

- [Mac M2 配置差异与优化建议](Mac_M2配置差异与优化建议.md)
- [环境检查报告](docs/环境检查报告.md)
- [环境配置文件](docs/环境配置文件.md)
- [Mac M2 环境配置指南](docs/Mac_M2环境配置指南.md)
- [版本差异报告](版本差异报告.md)

---

## 💡 提示

- 每次解决问题后，更新此文档
- 记录解决方案和遇到的问题
- 保持文档与实际情况同步
- 优先处理高优先级问题

---

**当前进度**: 1/5 问题已解决 (20%)
